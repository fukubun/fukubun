<div class="px-3 mt-3">
<a href="<%=
    from === 'review' ? '/tokumei_review' :
    from === 'tokumei_novel' ? '/tokumei_novel' :
    from === 'tokumei_save' ? '/tokumei_save' :
    from === 'tokumei_log' ? '/tokumei_log' :
    '/tokumei_novel'
  %>"
  class="text-body hover:text-heading text-sm flex items-center gap-1 mb-4">
    <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x-icon lucide-x"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
  </a>
</div>

<main class="pl-0 sm:pl-16 max-w-3xl mx-auto p-0 flex-1 min-w-0 px-4">

  <!-- タイトル -->
  <h1 class="text-2xl font-bold text-gray-900 mb-1">
    <%= novel.title || "（無題）" %>
  </h1>

  <!-- 投稿日時 -->
  <p class="text-sm text-gray-500 mb-6">
    <%= novel.time.toLocaleString('ja-JP') %>
  </p>

  <!-- 本文 -->
  <div class="prose whitespace-pre-wrap text-gray-800">
    <%= novel.message %>
  </div>

  <!-- 画像（任意） -->
  <% if (novel.image) { %>
    <div class="mt-6">
      <img src="<%= novel.image %>" alt="novel image" class="rounded-md shadow">
    </div>
  <% } %>

  <!-- 評価ボタン -->
  <div class="mt-6">
    <form action="/tokumei_review" method="POST" class="flex gap-3">

      <!-- ★ 小説は novel._id を使う（post.id は存在しない） -->
      <input type="hidden" name="postId" value="<%= novel._id %>">

      <!-- ★ redirect を 5ページ完全対応に -->
      <input type="hidden" name="redirect"
        value="<%=
          from === 'review' ? 'tokumei_review' :
          from === 'tokumei_log' ? 'tokumei_log' :
          from === 'tokumei_save' ? 'tokumei_save' :
          'tokumei_novel'
        %>">

      <!-- Bad -->
      <button type="submit" name="rating" value="bad"
        class="px-4 py-2 text-sm font-medium text-red-600 bg-red-50 border border-red-200 rounded-lg hover:bg-red-100 dark:bg-gray-800 dark:text-red-400 dark:border-red-500">
        Bad
      </button>

      <!-- いいね -->
      <button type="submit" name="rating" value="good"
        class="px-4 py-2 text-sm font-medium text-blue-600 bg-blue-50 border border-blue-200 rounded-lg hover:bg-blue-100 dark:bg-gray-800 dark:text-blue-400 dark:border-blue-500">
        いいね
      </button>

      <!-- 素晴らしい -->
      <button type="submit" name="rating" value="great"
        class="px-4 py-2 text-sm font-medium text-green-600 bg-green-50 border border-green-200 rounded-lg hover:bg-green-100 dark:bg-gray-800 dark:text-green-400 dark:border-green-500">
        素晴らしい
      </button>

    </form>
  </div>

</main>